# Docker build specific
PYTORCH_VARIANT_BUILD=cpu

# --- Application Settings ---
APP_NAME="SpotOn Backend"
API_V1_PREFIX="/api/v1"
DEBUG=False

# --- Production Endpoint Control ---
# Set to false to disable specific API endpoint groups
ENABLE_ANALYTICS_ENDPOINTS=true
ENABLE_EXPORT_ENDPOINTS=true
ENABLE_AUTH_ENDPOINTS=true
ENABLE_ADMIN_ENDPOINTS=false
PRODUCTION_MODE=false

# --- Security Configuration ---
# Comma-separated list of allowed CORS origins (use your frontend URLs in production)
ALLOWED_ORIGINS=http://localhost:3000,http://localhost:5173
# Comma-separated list of allowed host headers
ALLOWED_HOSTS=localhost,127.0.0.1
# Rate limiting - requests per minute per IP address
RATE_LIMIT_PER_MINUTE=60
# Enable security features
ENABLE_SECURITY_HEADERS=true
ENABLE_REQUEST_LOGGING=true
# Maximum request size in MB
MAX_REQUEST_SIZE_MB=10

# --- DagsHub / S3 Configuration ---
# Do NOT commit real credentials. For local dev use a non-committed .env;
# for production use Docker secrets or a secrets manager (SSM/Vault).

S3_ENDPOINT_URL="https://s3.dagshub.com"
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
S3_BUCKET_NAME="spoton_ml"

# S3 transfer settings
S3_CONNECT_TIMEOUT=10
S3_READ_TIMEOUT=60
S3_MAX_ATTEMPTS=5
S3_MAX_TRANSFER_CONCURRENCY=4
S3_MULTIPART_THRESHOLD_MB=16

# --- DagsHub Configuration (if still needed for other DagsHub library features) ---
DAGSHUB_REPO_OWNER=Jwizzed
DAGSHUB_REPO_NAME=spoton_ml

# --- Local Data Directories ---
LOCAL_VIDEO_DOWNLOAD_DIR=./downloaded_videos
LOCAL_FRAME_EXTRACTION_DIR=./extracted_frames
# Base directory inside the container for local videos
LOCAL_VIDEOS_BASE_DIR=/app/videos

# --- Phase 6: I/O & Caching ---
# Limit concurrent S3 downloads
MAX_DOWNLOAD_CONCURRENCY=3
# Optionally store extracted/annotated frames to disk while streaming
STORE_EXTRACTED_FRAMES=false
FRAME_CACHE_DIR=./extracted_frames
# Save every Nth frame (0 disables saving)
FRAME_CACHE_SAMPLE_RATE=0

# --- Redis Configuration ---
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_DB=0

# --- TimescaleDB (PostgreSQL) Configuration ---
POSTGRES_USER=${POSTGRES_USER:-spoton_user}
POSTGRES_PASSWORD=${POSTGRES_PASSWORD:-spoton_password}
POSTGRES_SERVER=timescaledb
POSTGRES_PORT=5432
POSTGRES_DB=${POSTGRES_DB:-spotondb}

# --- Database (Phase 7) ---
DB_ENABLED=true
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=30
DB_POOL_RECYCLE=3600
DB_POOL_PRE_PING=true

# --- AI Model Configuration ---
# Detector Settings
DETECTOR_TYPE="rtdetr"
PERSON_CLASS_ID=1
DETECTION_CONFIDENCE_THRESHOLD=0.5
DETECTION_USE_AMP=False
# Tracker Settings
TRACKER_TYPE="bytetrack"

# Weights directory
WEIGHTS_DIR="./weights"
TRACKER_HALF_PRECISION=False
TRACKER_PER_CLASS=False

# --- Homography Configuration ---
# Directory containing homography calibration files (NPZ and/or JSON)
HOMOGRAPHY_DATA_DIR="./homography_data"
# Source preference: 'auto' (JSON first, then NPZ), or 'json'/'npz' only
HOMOGRAPHY_SOURCE="auto"

# --- Startup Preload/Lazy Init ---
# Preload heavy components at startup (disable to reduce cold-start time)
PRELOAD_TRACKER_FACTORY=true
PRELOAD_HOMOGRAPHY=true

# --- Trail Management ---
START_TRAIL_CLEANUP=true
TRAIL_CLEANUP_INTERVAL_SECONDS=10
TRAIL_MAX_AGE_SECONDS=30
TRAIL_LENGTH=3

# --- RT-DETR (Detection) Weights Overrides (optional) ---
# If you have environment-specific RT-DETR weights, set one of these.
# If unset, the backend falls back to ./weights/<env>.pt or the default RTDETR_MODEL_PATH.
# You can also set EXTERNAL_WEIGHTS_BASE_DIR to a directory that contains
#   campus.pt and factory.pt to be picked up automatically.
#EXTERNAL_WEIGHTS_BASE_DIR="/absolute/path/to/spoton_ml/weights"
#RTDETR_MODEL_PATH_CAMPUS="/absolute/path/to/spoton_ml/weights/campus.pt"
#RTDETR_MODEL_PATH_FACTORY="/absolute/path/to/spoton_ml/weights/factory.pt"
